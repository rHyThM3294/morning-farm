import{_ as N,c as h,o as u,b as e,A as P,k as $,h as E,G as Q,F as I,r as O,t as o,B as R,n as X,u as Z,d as B,p as K,C as ee,J as W,y as z,g as p,l as j,a as G,j as F,P as te,I as se}from"./index-DYKNA_Rc.js";import{u as J}from"./order-Cgn2WGnQ.js";import"./product-D4pvNpAS.js";const ne={class:"tabWindow"},ae=["disabled"],le=["disabled"],oe={__name:"OrderSearchToggle",props:{activeType:{type:String,default:"orderId"}},emits:["change"],setup(a,{emit:g}){const c=a,v=g;function r(i){i!==c.activeType&&v("change",i)}return(i,n)=>(u(),h("div",ne,[e("button",{type:"button",class:P(["tabButton",{active:a.activeType==="orderId"}]),disabled:a.activeType==="orderId",onClick:n[0]||(n[0]=d=>r("orderId"))},[...n[2]||(n[2]=[e("h5",null,"從訂單編號",-1)])],10,ae),e("button",{type:"button",class:P(["tabButton",{active:a.activeType==="date"}]),disabled:a.activeType==="date",onClick:n[1]||(n[1]=d=>r("date"))},[...n[3]||(n[3]=[e("h5",null,"從訂單日期",-1)])],10,le),e("span",{class:P(["tabIndicator",a.activeType])},null,2)]))}},re=N(oe,[["__scopeId","data-v-34421655"]]),ie=["onClick"],de={__name:"OrderStatusFilter",props:{modelValue:{type:String,default:"all"}},setup(a){const g=[{value:"all",label:"全部"},{value:"unpaid",label:"未付款"},{value:"toShip",label:"待出貨"},{value:"delivered",label:"已配達"},{value:"returned",label:"已退回"},{value:"pickedUp",label:"已取件"},{value:"abnormal",label:"異常"},{value:"cancelled",label:"取消訂單"}],c=$(null),v=r=>{c.value&&c.value.scrollWidth>c.value.clientWidth&&(r.preventDefault(),c.value.scrollLeft+=r.deltaY)};return E(()=>{c.value&&c.value.addEventListener("wheel",v,{passive:!1})}),Q(()=>{c.value&&c.value.removeEventListener("wheel",v)}),(r,i)=>(u(),h("div",{ref_key:"scrollContainer",ref:c,class:"orderStatusFilter"},[(u(),h(I,null,O(g,n=>e("button",{key:n.value,class:P({active:a.modelValue===n.value}),onClick:d=>r.$emit("update:modelValue",n.value)},o(n.label),11,ie)),64))],512))}},ue=N(de,[["__scopeId","data-v-d5e2da6e"]]),ce={class:"searchResult"},ve={class:"allList"},he=["onClick"],fe={class:"listNumber"},me={class:"listDetail"},pe={class:"listDetailBox"},_e={class:"firstBox"},be={class:"productName"},ge={key:0},ye={class:"listDate"},$e={class:"buyer"},ke={class:"secondBox"},De={class:"row1"},Se={class:"numberUnit"},Te={class:"unit"},we={class:"price"},xe={class:"row2"},Ce={class:"price"},Pe={class:"row3"},Ie={class:"additionalPrice"},Oe={key:0,class:"pagination"},Ne=["disabled"],Me={class:"pageInfo"},Re=["disabled"],Be={__name:"SearchResult",props:{orders:{type:Array,default:()=>[]},currentPage:Number,totalPages:Number},emits:["selectOrder","changePage"],setup(a){const g="/morning-farm/";function c(v){var r;return((r=v==null?void 0:v.items)==null?void 0:r[0])||null}return(v,r)=>(u(),h("div",ce,[e("div",ve,[(u(!0),h(I,null,O(a.orders,i=>{var n,d,f;return u(),h("div",{class:"listCard",key:i.id,onClick:m=>v.$emit("selectOrder",i)},[e("div",fe,[e("p",null,"訂單編號 "+o(i.orderId),1)]),e("div",me,[e("div",{class:"productPicture",style:X({backgroundImage:`url(${Z(g)}image/chinese-pear.png)`})},null,4),e("div",pe,[e("div",_e,[e("p",be,[B(o(((n=c(i))==null?void 0:n.productName)||"-")+" ",1),i.items.length>1?(u(),h("span",ge," ＋"+o(i.items.length-1)+" 項商品 ",1)):R("",!0)]),e("p",ye,o(i.date),1),e("p",$e,"買家："+o(i.buyer),1)]),e("div",ke,[e("div",De,[e("div",Se,[r[2]||(r[2]=e("span",{class:"numbers"},null,-1)),e("p",Te,o(((d=c(i))==null?void 0:d.unit)||""),1)]),e("p",we," NT$ "+o(((f=c(i))==null?void 0:f.price)??"-"),1)]),e("div",xe,[r[3]||(r[3]=e("p",{class:"freight"},"運費：",-1)),e("p",Ce,"NT$ "+o(i.freight),1)]),e("div",Pe,[e("p",Ie," NT$ "+o(i.total),1)]),r[4]||(r[4]=e("div",{class:"row4"},[e("button",{type:"button",class:"lookDetail"},[B(" 查看詳情"),e("i",{class:"fa-solid fa-angles-right arrowLoop"})])],-1))])])])],8,he)}),128))]),a.totalPages>1?(u(),h("div",Oe,[e("button",{class:"pageButton",disabled:a.currentPage===1,onClick:r[0]||(r[0]=i=>v.$emit("changePage",a.currentPage-1))}," 上一頁 ",8,Ne),e("span",Me,o(a.currentPage)+" / "+o(a.totalPages),1),e("button",{class:"pageButton",disabled:a.currentPage===a.totalPages,onClick:r[1]||(r[1]=i=>v.$emit("changePage",a.currentPage+1))}," 下一頁 ",8,Re)])):R("",!0)]))}},Le=N(Be,[["__scopeId","data-v-f5b01d97"]]),Ue={class:"searchByNumber"},Ve={class:"rowOne"},Fe={class:"rowTwo"},He=["disabled"],Ye={__name:"SearchByNumber",emits:["search"],setup(a,{emit:g}){const c=g,v=$("");function r(){v.value&&c("search",{type:"orderId",keyword:v.value})}return(i,n)=>(u(),h("div",Ue,[e("div",Ve,[n[1]||(n[1]=e("label",null,"訂單編號",-1)),K(e("input",{type:"text",class:"fromNumber",placeholder:"輸入訂單編號","onUpdate:modelValue":n[0]||(n[0]=d=>v.value=d),onKeydown:W(r,["enter"])},null,544),[[ee,v.value]])]),e("div",Fe,[e("button",{type:"button",class:"enterNumber",disabled:!v.value,onClick:r}," 查詢 ",8,He)])]))}},qe=N(Ye,[["__scopeId","data-v-01535303"]]),Ae={class:"dateRangePicker"},Ee={class:"header"},Ke={class:"week"},We={class:"days"},ze=["disabled","onClick"],je={class:"result"},Ge={__name:"DateRangePicker",props:{maxRange:{type:Number,default:30}},emits:["update"],setup(a,{emit:g}){const c=a,v=g,r=z(),i=new Date,n=$(i.getFullYear()),d=$(i.getMonth()),f=$(null),m=$(null),D=new Date;D.setHours(0,0,0,0);function w(s){return s>D}const M=["日","一","二","三","四","五","六"],x=p(()=>new Date(n.value,d.value+1,0).getDate()),L=p(()=>{const s=new Date(n.value,d.value,1).getDay();return Array(s).fill(0)}),U=p(()=>f.value?V(f.value):""),_=p(()=>m.value?V(m.value):"");function y(s){const t=new Date(n.value,d.value,s);if(t.setHours(0,0,0,0),!f.value){if(w(t))return;f.value=t,m.value=null;return}if(!m.value){if(Math.abs(t-f.value)/864e5>c.maxRange){r.error(`最多只能選 ${c.maxRange} 天`);return}t<f.value?(m.value=f.value,f.value=t):m.value=t;return}w(t)||(f.value=t,m.value=null)}function k(s){const t=new Date(n.value,d.value,s);t.setHours(0,0,0,0);const l=!f.value&&w(t),b=f.value&&m.value&&w(t);return{start:C(t,f.value),end:C(t,m.value),inRange:f.value&&m.value&&t>f.value&&t<m.value,disabled:l||b}}function H(){d.value===0?(d.value=11,n.value--):d.value--}function Y(){d.value===11?(d.value=0,n.value++):d.value++}function V(s){const t=s.getFullYear(),l=String(s.getMonth()+1).padStart(2,"0"),b=String(s.getDate()).padStart(2,"0");return`${t}-${l}-${b}`}function C(s,t){return!s||!t?!1:s.toDateString()===t.toDateString()}return j([f,m],()=>{v("update",{start:f.value,end:m.value})}),(s,t)=>(u(),h("div",Ae,[e("div",Ee,[e("button",{onClick:H},"‹"),e("span",null,o(n.value)+" 年 "+o(d.value+1)+" 月",1),e("button",{onClick:Y},"›")]),e("div",Ke,[(u(),h(I,null,O(M,l=>e("span",{key:l},o(l),1)),64))]),e("div",We,[(u(!0),h(I,null,O(L.value,l=>(u(),h("span",{key:"b"+l,class:"blank"}))),128)),(u(!0),h(I,null,O(x.value,l=>(u(),h("button",{key:l,class:P(["day",k(l)]),disabled:k(l).disabled,onClick:b=>y(l)},o(l),11,ze))),128))]),e("p",je,[B(" 起："+o(U.value||"-"),1),t[0]||(t[0]=e("br",null,null,-1)),B(" 迄："+o(_.value||"-"),1)])]))}},Je=N(Ge,[["__scopeId","data-v-dea276b8"]]),Qe={class:"rowOne"},Xe={class:"selectDate"},Ze={class:"rowTwo"},et=["disabled"],tt={__name:"SearchByDate",emits:["search"],setup(a,{emit:g}){const c=g,v=$(null),r=$(null);function i(){d.value&&f()}function n({start:m,end:D}){v.value=m,r.value=D}const d=p(()=>!!(v.value&&r.value));function f(){c("search",{type:"date",start:v.value,end:r.value})}return(m,D)=>(u(),h("div",{class:"searchByDate",onKeydown:W(i,["enter"])},[e("div",Qe,[D[0]||(D[0]=e("label",null,"選擇日期區間（最多一個月）",-1)),e("div",Xe,[G(Je,{maxRange:31,onUpdate:n})])]),e("div",Ze,[e("button",{type:"button",class:"enterDate",disabled:!d.value,onClick:f}," 查詢 ",8,et)])],32))}},st=N(tt,[["__scopeId","data-v-bdff73ba"]]),nt={class:"allOrderDetailBox"},at={class:"box1"},lt={class:"boxTitle"},ot={class:"boxContainer"},rt={class:"informationLeft"},it={class:"right"},dt={class:"informationLeft"},ut={class:"right"},ct={class:"informationLeft"},vt={class:"right"},ht={class:"informationLeft"},ft={class:"right"},mt={class:"informationLeft"},pt={class:"right"},_t={class:"informationLeft"},bt=["disabled"],gt={class:"informationRight"},yt={class:"informationRight"},$t={class:"send"},kt={class:"total"},Dt={class:"box2"},St={class:"boxTitle"},Tt={class:"boxContainer"},wt={class:"buyer"},xt={class:"cellphone"},Ct={class:"address"},Pt={class:"status"},It={key:0,class:"finish"},Ot={class:"orderProcess"},Nt={class:"mfTimeline"},Mt={class:"mfTime"},Rt={class:"mfAxis"},Bt={key:0,class:"mfConnector"},Lt={class:"mfLabel"},Ut={class:"box3"},Vt={class:"boxTitle"},Ft={class:"boxContainer"},Ht={class:"payMuch"},Yt={class:"payStatus"},qt={class:"payTime"},At={class:"payProcess"},Et={class:"mfTimeline"},Kt={class:"mfTime"},Wt={class:"mfAxis"},zt={key:0,class:"mfConnector"},jt={class:"mfLabel"},Gt={class:"box4"},Jt={class:"boxContainer"},Qt={class:"buyerName"},Xt={class:"telephone"},Zt={class:"cellphone"},es={class:"email"},ts={class:"box5"},ss={class:"boxContainer"},ns={__name:"OrderDetail",props:{order:{type:Object,required:!0}},emits:["back","mounted"],setup(a,{emit:g}){const c=$(null),v=J(),r=z(),i=g;E(()=>{i("mounted",c.value)});const n=a;function d(){if(!window.confirm(`確定要取消訂單 ${n.order.orderId} 嗎？
取消後將無法復原。`))return;v.cancelOrder(n.order.orderId)?r.success("訂單已成功取消"):r.error("取消訂單失敗，請稍後再試")}const f=p(()=>(n.order.items||[]).reduce((s,t)=>s+(t.quantity||0),0)),m=p(()=>(n.order.items||[]).reduce((s,t)=>s+(t.price||0)*(t.quantity||0),0)),D={unpaid:"未付款",toShip:"待出貨",delivered:"已配達",returned:"退貨",pickedUp:"已取件",abnormal:"異常",cancelled:"已取消"},w=p(()=>D[n.order.status]||n.order.status||""),M=p(()=>{const s=n.order.status;return s==="cancelled"?{show:!0,label:"取消",time:n.order.cancelTime||n.order.date}:s==="delivered"||s==="pickedUp"?{show:!0,label:"完成",time:n.order.finishTime||n.order.payTime||n.order.date}:{show:!1}}),x=p(()=>n.order.shippingMethod==="現場自取"),L=p(()=>x.value?["訂單成立","已接單","已取件","完成訂單"]:["訂單成立","已接單","寄出","已配達","已取件","完成訂單"]),U=p(()=>{const s=n.order.status;return s==="unpaid"?0:s==="toShip"||s==="cancelled"?1:x.value?s==="pickedUp"||s==="delivered"?3:1:s==="delivered"?3:s==="pickedUp"?5:s==="returned"||s==="abnormal"?3:1});function _(s){if(!s)return null;if(s instanceof Date)return s;if(typeof s=="string"&&/^\d{4}-\d{2}-\d{2}$/.test(s)){const[t,l,b]=s.split("-").map(Number);return new Date(t,l-1,b,0,0,0)}return new Date(s)}function y(s,t){const l=new Date(s.getTime());return l.setHours(l.getHours()+t),l}const k=p(()=>{const s=L.value,t=Math.min(U.value,s.length-1),l=x.value?[0,2,6,10]:[0,2,24,48,72,80],b=_(n.order.date)||new Date;return s.map((S,T)=>{const q=T<t?"done":T===t?"current":"pending";return{key:`order-${T}`,label:S,state:q,time:T<=t?y(b,l[T]??T*12):null}})}),H=["選擇付款方式","已付款","款項撥款至賣家","完成訂單"],Y=p(()=>{if(!n.order.isPaid)return 0;let s=1;return["delivered","pickedUp","returned","cancelled"].includes(n.order.status)&&(s=2),n.order.status==="pickedUp"&&(s=3),s}),V=p(()=>{const s=Math.min(Y.value,H.length-1),t=_(n.order.date)||new Date,l=[0,1,48,80];return H.map((b,S)=>{const T=S<s?"done":S===s?"current":"pending";return{key:`pay-${S}`,label:b,state:T,time:S<=s?y(t,l[S]??S*12):null}})});function C(s){if(!s)return"";const t=new Date(s),l=t.getFullYear(),b=String(t.getMonth()+1).padStart(2,"0"),S=String(t.getDate()).padStart(2,"0"),T=String(t.getHours()).padStart(2,"0"),q=String(t.getMinutes()).padStart(2,"0");return`${l}/${b}/${S}  ${T}:${q}`}return(s,t)=>(u(),h("div",{class:"orderDetail",ref_key:"orderDetailRef",ref:c},[e("button",{type:"button",class:"backToSearchResult",onClick:t[0]||(t[0]=l=>i("back"))}," 返回搜尋結果 "),e("div",nt,[e("div",at,[e("div",lt,[e("p",null,"訂單編號 "+o(a.order.orderId),1)]),e("div",ot,[e("div",rt,[t[2]||(t[2]=e("p",{class:"left"},"接單時間",-1)),e("p",it,o(C(a.order.date)),1)]),e("div",dt,[t[3]||(t[3]=e("p",{class:"left"},"買家",-1)),e("p",ut,o(a.order.buyer),1)]),(u(!0),h(I,null,O(a.order.items,l=>(u(),h("div",{class:"productGroup",key:l.productId},[e("div",ct,[t[4]||(t[4]=e("p",{class:"left"},"商品名稱",-1)),e("p",vt,o(l.productName),1)]),e("div",ht,[t[5]||(t[5]=e("p",{class:"left"},"數量",-1)),e("p",ft,o(l.quantity),1)]),e("div",mt,[t[6]||(t[6]=e("p",{class:"left"},"商品小計",-1)),e("p",pt,"NT$"+o(l.price*l.quantity),1)])]))),128)),e("div",_t,[t[7]||(t[7]=e("p",{class:"left"},"訂單管理",-1)),e("button",{type:"button",class:P(["cancel",{disabled:a.order.status==="cancelled"}]),onClick:d,disabled:a.order.status==="cancelled"},o(a.order.status==="cancelled"?"已取消":"取消訂單"),11,bt)]),e("div",gt,[e("p",null,[B(" 商品共"+o(a.order.items.length)+"項， ",1),e("span",null,o(f.value)+"件",1)]),e("p",null,"NT$"+o(m.value),1)]),e("div",yt,[e("p",$t,"("+o(a.order.payMethod)+")",1),e("p",null,"運費 NT$"+o(a.order.freight),1)]),e("div",kt,[e("h6",null,"合計 NT$"+o(a.order.total),1)])])]),e("div",Dt,[e("div",St,[e("p",null,"運送方式："+o(a.order.shippingMethod),1)]),e("div",Tt,[e("div",wt,[e("p",null,"收件人："+o(a.order.buyer),1)]),e("div",xt,[e("p",null,"手機號碼："+o(a.order.phone),1)]),e("div",Ct,[e("p",null,"地址："+o(a.order.address),1)]),e("div",Pt,[e("p",null,"訂單狀態："+o(w.value),1)]),M.value.show?(u(),h("div",It,[e("p",null,[e("span",null,o(M.value.label)+"時間：",1),B(" "+o(C(M.value.time)),1)])])):R("",!0),e("div",Ot,[e("ul",Nt,[(u(!0),h(I,null,O(k.value,(l,b)=>(u(),h("li",{key:l.key,class:P(["mfStep",{"is-done":l.state==="done","is-current":l.state==="current","is-pending":l.state==="pending"}])},[e("div",Mt,o(l.time?C(l.time):"----"),1),e("div",Rt,[t[8]||(t[8]=e("span",{class:"mfDot"},null,-1)),b<k.value.length-1?(u(),h("span",Bt)):R("",!0)]),e("div",Lt,o(l.label),1)],2))),128))])])])]),e("div",Ut,[e("div",Vt,[e("p",null,"付款方式："+o(a.order.payMethod),1)]),e("div",Ft,[e("div",Ht,[e("p",null,"應付金額 NT$ "+o(a.order.total),1)]),e("div",Yt,[e("p",null,"付款狀態："+o(a.order.isPaid?"已付款":"尚未付款"),1)]),e("div",qt,[e("p",null," 付款時間： "+o(a.order.payTime?C(a.order.payTime):"----"),1)]),e("div",At,[e("ul",Et,[(u(!0),h(I,null,O(V.value,(l,b)=>(u(),h("li",{key:l.key,class:P(["mfStep",{"is-done":l.state==="done","is-current":l.state==="current","is-pending":l.state==="pending"}])},[e("div",Kt,o(l.time?C(l.time):"----"),1),e("div",Wt,[t[9]||(t[9]=e("span",{class:"mfDot"},null,-1)),b<V.value.length-1?(u(),h("span",zt)):R("",!0)]),e("div",jt,o(l.label),1)],2))),128))])])])]),e("div",Gt,[t[10]||(t[10]=e("div",{class:"boxTitle"},[e("p",null,"買家資訊")],-1)),e("div",Jt,[e("div",Qt,[e("p",null,"買家姓名："+o(a.order.buyer),1)]),e("div",Xt,[e("p",null,"買家電話："+o(a.order.telephone||a.order.phone),1)]),e("div",Zt,[e("p",null,"買家手機："+o(a.order.phone),1)]),e("div",es,[e("p",null,"買家電子信箱："+o(a.order.email),1)])])]),e("div",ts,[t[11]||(t[11]=e("div",{class:"boxTitle"},[e("p",null,"備註")],-1)),e("div",ss,o(a.order.remark||"此買家什麼都沒留"),1)])]),e("button",{type:"button",class:"backToSearchResult",onClick:t[1]||(t[1]=l=>i("back"))}," 返回搜尋結果 ")],512))}},as=N(ns,[["__scopeId","data-v-acbfdb57"]]),ls={class:"checkOrder"},os={class:"searchOrder"},rs={class:"orderResult"},A=10,is={__name:"CheckOrder",emits:["scroll-to-order-detail"],setup(a,{emit:g}){const c=$("orderId"),v=$(!1),r=$("all"),i=J(),n=$(1),d=$(null),f=g,m=p(()=>r.value==="all"?i.searchResult:i.searchResult.filter(_=>_.status===r.value)),D=p(()=>d.value?i.orders.find(_=>_.orderId===d.value):null),w=p(()=>Math.ceil(m.value.length/A)),M=p(()=>{const _=(n.value-1)*A;return m.value.slice(_,_+A)});function x(_){v.value=!0,d.value=null,n.value=1,i.searchOrders(_)}function L(_){d.value=_.orderId}j(r,()=>{n.value=1});function U(_){se(()=>{f("scroll-to-order-detail",_)})}return(_,y)=>(u(),h("div",ls,[e("div",os,[y[4]||(y[4]=e("h2",null,"查詢訂單",-1)),G(re,{activeType:c.value,onChange:y[0]||(y[0]=k=>c.value=k)},null,8,["activeType"]),c.value==="orderId"?(u(),F(qe,{key:0,onSearch:x})):(u(),F(st,{key:1,onSearch:x}))]),K(e("div",rs,[d.value?R("",!0):(u(),F(ue,{key:0,modelValue:r.value,"onUpdate:modelValue":y[1]||(y[1]=k=>r.value=k)},null,8,["modelValue"])),d.value?(u(),F(as,{key:2,order:D.value,onBack:y[3]||(y[3]=k=>d.value=null),onMounted:U},null,8,["order"])):(u(),F(Le,{key:1,orders:M.value,currentPage:n.value,totalPages:w.value,onChangePage:y[2]||(y[2]=k=>n.value=k),onSelectOrder:L},null,8,["orders","currentPage","totalPages"]))],512),[[te,v.value]])]))}},vs=N(is,[["__scopeId","data-v-7050e998"]]);export{vs as default};

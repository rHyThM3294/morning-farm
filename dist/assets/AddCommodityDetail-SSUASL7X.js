import{_ as R,y as G,k as w,g as P,l as H,c as p,b as l,p as u,C as r,t as T,F as K,r as X,B as U,d as n,K as a,D as j,o as m,I as L}from"./index-BvZFee3Y.js";import{u as z}from"./adminProduct-D-tY0yd7.js";const J={class:"add-commodity"},Q={class:"upload-section"},W={class:"upload-status"},Y={class:"preview-container"},Z=["src"],_=["onClick"],h={key:0,class:"main-badge"},tt={class:"unit-group"},et={class:"form-group"},lt={class:"radio-group"},ot={class:"radio-option"},it={class:"radio-option"},ut={class:"radio-group"},st={class:"radio-option"},nt={class:"radio-option"},at={class:"radio-option"},rt={class:"button-group"},dt={class:"addButton",type:"submit"},I=4,B="清晨農鋪合作小農",pt={__name:"AddCommodityDetail",props:{editingId:{type:[String,Number],default:null}},emits:["back"],setup(S,{emit:x}){const b=z(),v=G(),f=x,g=S,c=w([]),e=w({productName:"",productTag:"",subTag:"",unit:"",customUnit:"",originalPrice:"",price:"",stock:"充足",settings:"",description:"",imageList:[]}),y=P(()=>g.editingId!==null),V=P(()=>b.products.find(i=>i.id===g.editingId)||null);H(()=>g.editingId,i=>{if(!i||!V.value)return;const t=V.value;e.value={productName:t.productTitle,productTag:t.productTag,subTag:t.subTag,unit:t.unit,customUnit:t.unit,originalPrice:t.originalPrice||"",price:t.price,stock:t.isOutOfStock?"補貨中":"充足",settings:Array.isArray(t.settings)?t.settings[0]||"":t.settings||t.status||"",description:t.description||"",imageList:[...t.imageList||[]]},c.value=[...t.imageList||[]]},{immediate:!0});function A(){e.value={productName:"",productTag:"",subTag:"",unit:"",customUnit:"",originalPrice:"",price:"",stock:"充足",settings:[],description:"",imageList:[]}}async function C(){if(e.value.imageList.length<2){v.error("請至少上傳 2 張商品圖片");return}const i={productTitle:e.value.productName,productTag:e.value.productTag,subTag:e.value.subTag,unit:e.value.unit==="自訂"?e.value.customUnit:e.value.unit,originalPrice:e.value.originalPrice?Number(e.value.originalPrice):0,price:e.value.price,isOutOfStock:e.value.stock==="補貨中",status:e.value.settings||"",settings:e.value.settings?[e.value.settings]:[],imageList:[...e.value.imageList],description:e.value.description,farmerName:B};if(y.value){b.updateProduct(g.editingId,i),v.success("商品更新成功！"),await L(),f("back");return}b.addProduct({id:Date.now(),...i}),v.success("商品新增成功！"),A(),await L(),f("back")}function q(i){const t=Array.from(i.target.files);if(t.length){if(c.value.length+t.length>I){v.error(`最多只能上傳 ${I} 張圖片`),i.target.value="";return}t.forEach(d=>{const o=new FileReader;o.onload=s=>{c.value.push(s.target.result),e.value.imageList.push(s.target.result)},o.readAsDataURL(d)}),i.target.value=""}}function D(i){c.value.splice(i,1),e.value.imageList.splice(i,1)}function M(){f("back")}function $(){window.confirm("確定要刪除這個商品嗎？此動作無法復原！")&&(b.deleteProduct(g.editingId),v.success("商品已刪除"),f("back"))}function F(){const i=e.value.productName||"這項商品",t=e.value.productTag||"用心栽培",d=e.value.unit||"單位",o=e.value.stock==="補貨中"?"目前採收量有限，正等待下一批成熟。":"目前供應穩定，歡迎安心選購。",s=[`在臺灣這片土地上，${i}以${t}的方式孕育而生。`,`${i}來自小農細心照料的田間，是一份充滿溫度的農作。`,`我們相信，好的${i}，來自對土地的尊重與耐心等待。`],N=["從栽種到採收，每一個環節都經過層層把關，只為保留最自然的風味。","小農依照季節節奏調整作息，讓作物在最適合的時刻成熟。","不追求產量，而是專注於品質，是我們與小農共同的堅持。"],E=[`每${d}都蘊含著土地的心意，適合與家人一同分享。`,`無論是日常料理或特別時刻，${i}都能為餐桌增添風味。`,"希望這份來自土地的禮物，能成為你生活中的一部分。"],O=k(s)+k(N)+o+k(E);e.value.description=O}function k(i){return i[Math.floor(Math.random()*i.length)]}return(i,t)=>{var d;return m(),p("div",J,[l("form",{class:"commodity-form",onSubmit:j(C,["prevent"])},[t[25]||(t[25]=l("p",{class:"required-text"},"*為必填欄位",-1)),t[26]||(t[26]=l("label",{class:"required"},"商品名稱",-1)),u(l("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>e.value.productName=o),type:"text",placeholder:"請輸入商品名稱",required:""},null,512),[[r,e.value.productName]]),l("div",Q,[t[15]||(t[15]=l("label",{class:"required"},null,-1)),l("input",{ref:"fileInput",type:"file",multiple:"",accept:"image/*",onChange:q},null,544),l("p",W," 已上傳 "+T(((d=e.value.imageList)==null?void 0:d.length)||0)+" 張（最少上傳 2 張） ",1),l("div",Y,[(m(!0),p(K,null,X(c.value,(o,s)=>(m(),p("div",{key:s,class:"preview-item"},[l("img",{src:o,alt:"預覽圖片"},null,8,Z),l("button",{type:"button",class:"remove-img",onClick:N=>D(s)}," ✕ ",8,_),s===0?(m(),p("span",h," 主圖 ")):U("",!0)]))),128))])]),t[27]||(t[27]=l("label",{class:"required"},"商品標籤",-1)),u(l("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>e.value.productTag=o),type:"text",placeholder:"請輸入標籤"},null,512),[[r,e.value.productTag]]),t[28]||(t[28]=l("label",null,"商品次標籤",-1)),u(l("input",{"onUpdate:modelValue":t[2]||(t[2]=o=>e.value.subTag=o),type:"text",placeholder:"可選填"},null,512),[[r,e.value.subTag]]),l("p",{class:"farmerName"},"小農："+T(B)),t[29]||(t[29]=l("label",{class:"required"},"販售的每一單位",-1)),l("div",tt,[l("label",null,[u(l("input",{type:"radio",value:"盒","onUpdate:modelValue":t[3]||(t[3]=o=>e.value.unit=o)},null,512),[[a,e.value.unit]]),t[16]||(t[16]=n("盒",-1))]),l("label",null,[u(l("input",{type:"radio",value:"斤","onUpdate:modelValue":t[4]||(t[4]=o=>e.value.unit=o)},null,512),[[a,e.value.unit]]),t[17]||(t[17]=n("斤",-1))]),l("label",null,[u(l("input",{type:"radio",value:"自訂","onUpdate:modelValue":t[5]||(t[5]=o=>e.value.unit=o)},null,512),[[a,e.value.unit]]),t[18]||(t[18]=n("自訂",-1))]),e.value.unit==="自訂"?u((m(),p("input",{key:0,type:"text","onUpdate:modelValue":t[6]||(t[6]=o=>e.value.customUnit=o),placeholder:"自訂單位"},null,512)),[[r,e.value.customUnit]]):U("",!0)]),t[30]||(t[30]=l("label",null,"原價",-1)),u(l("input",{"onUpdate:modelValue":t[7]||(t[7]=o=>e.value.originalPrice=o),type:"number",placeholder:"請輸入原價"},null,512),[[r,e.value.originalPrice,void 0,{number:!0}]]),t[31]||(t[31]=l("label",{class:"required"},"售價",-1)),u(l("input",{"onUpdate:modelValue":t[8]||(t[8]=o=>e.value.price=o),type:"number",required:"",placeholder:"請輸入售價"},null,512),[[r,e.value.price,void 0,{number:!0}]]),l("div",et,[t[21]||(t[21]=l("label",{class:"required field-title"},"庫存狀態",-1)),l("div",lt,[l("label",ot,[u(l("input",{type:"radio",value:"充足","onUpdate:modelValue":t[9]||(t[9]=o=>e.value.stock=o)},null,512),[[a,e.value.stock]]),t[19]||(t[19]=n(" 貨源充足 ",-1))]),l("label",it,[u(l("input",{type:"radio",value:"補貨中","onUpdate:modelValue":t[10]||(t[10]=o=>e.value.stock=o)},null,512),[[a,e.value.stock]]),t[20]||(t[20]=n(" 補貨中 ",-1))])])]),t[32]||(t[32]=l("label",null,"其他設定（單選）",-1)),l("div",ut,[l("label",st,[u(l("input",{type:"radio",value:"Hot","onUpdate:modelValue":t[11]||(t[11]=o=>e.value.settings=o)},null,512),[[a,e.value.settings]]),t[22]||(t[22]=n(" Hot ",-1))]),l("label",nt,[u(l("input",{type:"radio",value:"New","onUpdate:modelValue":t[12]||(t[12]=o=>e.value.settings=o)},null,512),[[a,e.value.settings]]),t[23]||(t[23]=n(" New ",-1))]),l("label",at,[u(l("input",{type:"radio",value:"可自取","onUpdate:modelValue":t[13]||(t[13]=o=>e.value.settings=o)},null,512),[[a,e.value.settings]]),t[24]||(t[24]=n(" 可自取 ",-1))])]),t[33]||(t[33]=l("label",null,"商品詳細介紹 / 故事 / 想補充的",-1)),u(l("textarea",{"onUpdate:modelValue":t[14]||(t[14]=o=>e.value.description=o),placeholder:"請輸入詳細內容"},null,512),[[r,e.value.description]]),l("div",rt,[y.value?(m(),p("button",{key:0,type:"button",class:"deleteBottomButton",onClick:$}," 刪除 ")):U("",!0),l("button",{type:"button",class:"storyButton",onClick:F}," 自動生成故事 "),l("button",{type:"button",class:"cancelButton",onClick:M}," 取消 "),l("button",dt,T(y.value?"編輯完成":"新增"),1)])],32)])}}},gt=R(pt,[["__scopeId","data-v-8e2d7eb3"]]);export{gt as default};

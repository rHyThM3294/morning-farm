import{_ as T,k as s,g as l,l as k,c as v,a as n,b as o,p as N,v as q,F as g,r as A,t as D,q as I,o as i,j as L,m as x}from"./index-uehdW3nq.js";import{u as z}from"./product-D7PI6L6d.js";import{T as F}from"./TopBar-DR4QmC9R.js";import{P as H}from"./Produce-DoZtC65u.js";import{C as M}from"./Card-BtdMC1CX.js";import{P as R}from"./Page-CS29V-mf.js";import{A as U}from"./AsideButton-DpPc_o43.js";import"./favorite-CaSrRe4c.js";/* empty css                                                             */const j={class:"productContainer"},E={class:"sortBar"},O={class:"containerCards"},Q={class:"paginationBlock"},d=9,Y={__name:"ProductsView",setup(G){const f=z(),h=I(),r=s(1),m=s(""),c=s("all"),u=s("date"),P=[{label:"所有商品",value:"all"},{label:"可長久保存",value:"longTime"},{label:"素食",value:"vegetarianism"},{label:"加工食品",value:"process"},{label:"過節禮盒",value:"festival"}],w=l(()=>{const e=m.value.trim().toLowerCase(),t=c.value;return f.allProducts.filter(a=>{const S=t==="all"||a.category===t,V=!e||a.productTitle.toLowerCase().includes(e)||a.sellerName.toLowerCase().includes(e);return S&&V})}),p=l(()=>{const e=[...w.value];switch(u.value){case"price":return e.sort((t,a)=>t.price-a.price);case"farmer":return e.sort((t,a)=>t.sellerName.localeCompare(a.sellerName,"zh-Hant"));case"category":return e.sort((t,a)=>t.category.localeCompare(a.category,"zh-Hant"));case"date":default:return e.sort((t,a)=>new Date(a.createdAt)-new Date(t.createdAt))}}),y=l(()=>Math.ceil(p.value.length/d)),C=l(()=>{const e=(r.value-1)*d;return p.value.slice(e,e+d)});function _(){const e=document.querySelector(".containerCards");if(e){const t=e.getBoundingClientRect().top+window.scrollY-80;window.scrollTo({top:t,behavior:"smooth"})}}function B(e){c.value=e,r.value=1}function b(e){m.value=e,r.value=1}return k(()=>h.query.category,e=>{e&&(c.value=e,r.value=1)},{immediate:!0}),(e,t)=>(i(),v(g,null,[n(F,{title:"所有商品",buttons:P,searchPlaceholder:"搜尋商品",onSelectButton:B,onSearch:b}),n(H),o("div",j,[o("div",E,[t[3]||(t[3]=o("label",null,"排序方式：",-1)),N(o("select",{"onUpdate:modelValue":t[0]||(t[0]=a=>u.value=a)},[...t[2]||(t[2]=[o("option",{value:"date"},"依照上架日期",-1),o("option",{value:"farmer"},"依照小農",-1),o("option",{value:"category"},"依照種類",-1),o("option",{value:"price"},"依照價格",-1)])],512),[[q,u.value]])]),o("div",O,[(i(!0),v(g,null,A(C.value,a=>(i(),L(M,x({key:a.id},{ref_for:!0},a),null,16))),128))])]),o("div",Q,[n(R,{totalPages:y.value,modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=a=>r.value=a),onPageChanged:_},null,8,["totalPages","modelValue"]),o("p",null,"目前頁數："+D(r.value),1)]),n(U)],64))}},oe=T(Y,[["__scopeId","data-v-1e6fd1ae"]]);export{oe as default};

import{_ as re,x as ce,y as ue,q as de,g as d,z as ve,k as v,l as pe,c as p,a as G,b as e,F as z,r as Q,t as n,A as g,B as me,p as fe,C as _e,D as ge,d as L,e as he,o as m}from"./index-CgT4g50Q.js";import{B as ye}from"./Bread-CYe1r1Ak.js";import{A as be}from"./AsideButton-Bk1Wd5Ff.js";import{u as ke}from"./product-C4p6FVWg.js";import{u as Ne}from"./favorite-DFaAH1ML.js";const we={class:"detailPage"},Ce={class:"productSection"},Be={class:"gallery"},xe={class:"mainImage"},Te=["src","alt"],Fe={class:"thumbs"},Se=["onClick"],$e=["src","alt"],Ae={class:"info"},De=["data-type"],Ie={class:"desc"},Ee={class:"titleRow"},Ue={class:"title"},qe={class:"meta"},Pe={class:"price"},Me={class:"specs"},Ve={class:"specButtons"},Re=["onClick"],Ge={class:"quantityRow"},ze={class:"qtyControl"},Qe=["disabled"],Le=["disabled"],He={class:"stock"},Ke={key:0,class:"warn"},We={class:"actions"},je=["disabled"],Je=["disabled"],Oe={class:"farmerSection"},Xe={class:"farmerCard"},Ye={class:"farmerName"},Ze={class:"farmerInfo"},et=["src","alt"],tt={class:"farmerDesc"},st={__name:"ProductsDetailView",setup(at){var F,S,$,A,D,I,E,U,q,P,M,V,R;const H=ke(),C=Ne(),K=ce(),f=ue(),W=de(),j=he(),J=W.params.id,B="/morning-farm/",o=d(()=>H.getProductById(J));function _(l,a="#f0f0f0",i="#555"){const u=`
  <svg xmlns="http://www.w3.org/2000/svg" width="600" height="600" viewBox="0 0 600 600">
    <defs>
      <linearGradient id="g${l}" x1="0" y1="0" x2="1" y2="1">
        <stop offset="0%" stop-color="${a}"/>
        <stop offset="100%" stop-color="#ffffff"/>
      </linearGradient>
    </defs>
    <rect width="600" height="600" fill="url(#g${l})"/>
    <text x="50%" y="50%" font-size="120" font-family="system-ui" fill="${i}"
      text-anchor="middle" dominant-baseline="middle">#${l}</text>
  </svg>
  `;return`data:image/svg+xml;utf8,${encodeURIComponent(u)}`}const h=[_(1,"#E3F2FD","#0D47A1"),_(2,"#E8F5E9","#1B5E20"),_(3,"#FFF3E0","#E65100"),_(4,"#F3E5F5","#4A148C")],t=ve({id:((F=o.value)==null?void 0:F.id)??"temp-1",productTitle:((S=o.value)==null?void 0:S.productTitle)??"寶島甘露梨",sellerName:(($=o.value)==null?void 0:$.sellerName)??"王建國果園",price:((A=o.value)==null?void 0:A.price)??420,status:((D=o.value)==null?void 0:D.status)??"New",category:((I=o.value)==null?void 0:I.category)??"all",imageUrl:`${B}image/chinese-pear.png`,gallery:[`${B}image/chinese-pear.png`,h[1],h[2],h[3]],description:((E=o.value)==null?void 0:E.description)??"以自然農法種植，果肉脆甜多汁，冷藏風味更佳。下單後新鮮採收直送。",specs:((U=o.value)==null?void 0:U.specs)??[{label:"6 顆 / 盒",value:6},{label:"10 顆 / 箱",value:10},{label:"12 顆 / 箱",value:12}],sellerAvatarUrl:((q=o.value)==null?void 0:q.sellerAvatarUrl)??"/morning-farm/image/sandPear.png",farmerDescription:((P=o.value)==null?void 0:P.farmerDescription)??"堅持產地直送、友善耕作超過二十年。"}),x=d(()=>C.isFavorited(t.id)),y=v(!1),O=d(()=>x.value?"fa-solid fa-heart":"fa-regular fa-heart");function X(){y.value=!0,setTimeout(()=>y.value=!1,300),C.toggle({id:t.id,productTitle:t.productTitle,sellerName:t.sellerName,price:t.price,imageUrl:t.imageUrl,category:t.category})?f.success("已加入最愛"):f.info("已取消最愛")}const b=v(t.gallery[0]),T=v(((M=o.value)==null?void 0:M.stock)??500),k=v(((R=(V=t.specs)==null?void 0:V[0])==null?void 0:R.value)??null),N=d(()=>Number(k.value)||1),c=d(()=>Math.floor(T.value/N.value)),s=v(1),r=v("1");function Y(l){const a=Number.isFinite(Number(l))?Number(l):1;return Math.max(1,Math.min(c.value,Math.floor(a)))}function Z(){r.value=r.value.replace(/[^\d]/g,"")}function ee(){s.value=Y(r.value||"1"),r.value=String(s.value)}function te(){s.value=Math.min(s.value+1,c.value),r.value=String(s.value)}function se(){s.value=Math.max(s.value-1,1),r.value=String(s.value)}function ae(l){["Backspace","Delete","ArrowLeft","ArrowRight","Tab","Enter"].includes(l.key)||/^\d$/.test(l.key)||l.preventDefault()}pe(s,()=>r.value=String(s.value),{immediate:!0});const w=d(()=>s.value>=1&&s.value<=c.value);function le(){w.value&&(K.addItem({id:t.id,productTitle:t.productTitle,price:t.price,imageUrl:t.imageUrl,sellerName:t.sellerName,unit:`${N.value} 顆 / 組`,category:t.category,quantity:s.value,pieces:s.value*N.value}),f.success("成功加入購物車！"))}function oe(){f.info("尚未開放直接購買")}function ie(){j.push({name:"farmerDetail",params:{id:t.sellerName}})}return(l,a)=>(m(),p("div",we,[G(ye),e("section",Ce,[e("div",Be,[e("div",xe,[e("img",{src:b.value,alt:t.productTitle},null,8,Te)]),e("div",Fe,[(m(!0),p(z,null,Q(t.gallery,(i,u)=>(m(),p("button",{key:u,class:g(["thumbBtn",{active:b.value===i}]),onClick:ne=>b.value=i},[e("img",{src:i,alt:`${t.productTitle}-image-${u+1}`},null,8,$e)],10,Se))),128))])]),e("div",Ae,[e("span",{class:"tag","data-type":t.status},n(t.status),9,De),e("div",Ie,[e("p",null,n(t.description),1)]),e("div",Ee,[e("h4",Ue,n(t.productTitle),1),e("button",{class:g(["heart",{active:x.value,animate:y.value}]),onClick:X},[e("i",{class:g(O.value)},null,2)],2)]),e("div",qe,[e("span",Pe,"NT$ "+n(t.price),1)]),e("div",Me,[a[2]||(a[2]=e("p",{class:"label"},"選擇規格：",-1)),e("div",Ve,[(m(!0),p(z,null,Q(t.specs,(i,u)=>(m(),p("button",{key:u,class:g(["specBtn",{selected:k.value===i.value}]),onClick:ne=>k.value=i.value},n(i.label),11,Re))),128))])]),e("div",Ge,[a[3]||(a[3]=e("p",{class:"label"},"數量：",-1)),e("div",ze,[e("button",{class:"qtyBtn",onClick:se,disabled:s.value<=1},"-",8,Qe),fe(e("input",{class:"qtyInput",type:"text","onUpdate:modelValue":a[0]||(a[0]=i=>r.value=i),onInput:Z,onBlur:ee,onKeydown:ae,onWheel:a[1]||(a[1]=ge(()=>{},["prevent"]))},null,544),[[_e,r.value]]),e("button",{class:"qtyBtn",onClick:te,disabled:s.value>=c.value}," + ",8,Le)]),e("span",He," 庫存："+n(c.value)+" 組（共 "+n(T.value)+" ） ",1),s.value>c.value?(m(),p("span",Ke," 此規格可購買組數僅剩 "+n(c.value)+" 組 ",1)):me("",!0)]),e("div",We,[e("button",{class:"buyNow",onClick:oe,disabled:!w.value},[...a[4]||(a[4]=[L(" 直接購買 ",-1),e("i",{class:"fa-solid fa-cart-shopping"},null,-1)])],8,je),e("button",{class:"addCart",onClick:le,disabled:!w.value},[...a[5]||(a[5]=[L(" 加入購物車 ",-1),e("i",{class:"fa-solid fa-cart-shopping"},null,-1)])],8,Je)])])]),e("section",Oe,[e("div",Xe,[e("h4",Ye,"【"+n(t.sellerName)+"】",1),e("div",Ze,[e("img",{class:"avatar",src:t.sellerAvatarUrl,alt:t.sellerName},null,8,et),e("p",tt,n(t.farmerDescription),1)]),e("button",{class:"viewAllButton",onClick:ie}," 查看 "+n(t.sellerName)+" 的所有商品 ",1)])]),G(be)]))}},ct=re(st,[["__scopeId","data-v-5b921d0c"]]);export{ct as default};

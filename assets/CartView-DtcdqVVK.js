import{u as I}from"./product-kCck9Sxu.js";import{_ as q,y as D,x as U,g as l,c as r,b as t,a as h,B as E,F as u,r as y,u as k,f as F,t as c,e as V,o as n,A as L,j as W,E as j}from"./index-Hjgyp-bP.js";import{P as M}from"./Partition-Bnhxq9ZJ.js";import{C as z}from"./Card-DacKoiOk.js";import{A as G}from"./AsideButton-CXhDrZcS.js";import{u as O}from"./favorite-Dc1mkNKx.js";const Q={class:"cartContainer"},R={class:"cartProduct"},H=["id"],J={class:"productList"},K={class:"productPhoto"},X=["src"],Y={class:"productDetail"},Z={class:"productText"},tt=["onClick"],st={class:"attention"},ot={class:"stand"},et={class:"cartIcon"},at=["onClick"],ct=["onClick"],it={class:"priceList"},nt={class:"much"},rt={class:"number"},dt={class:"many"},lt=["onClick"],ut=["value","onInput"],pt=["onClick"],vt={class:"howMuch"},ft={class:"number"},_t={class:"cartPrice"},gt={class:"box1"},mt={class:"productPrice"},bt={class:"number"},ht={class:"freight"},yt={class:"number"},kt={class:"box2"},Ct={class:"allPrice"},Tt={class:"number"},$t={key:0,class:"recommendSection"},Nt={class:"recommendList"},Pt={__name:"CartView",setup(wt){const p=D(),i=U(),v=V(),f=O();function C(s){v.push({name:"productDetail",params:{category:s.category,id:s.id}})}const d="/morning-farm/",T=`${d}image/chinese-pear.png`;function $(s){return s?/^https?:\/\//.test(s)||s.startsWith(`${d}image/`)?s:s.startsWith("/image/")||s.startsWith("image/")?`${d}${s.replace(/^\/+/,"")}`:`${d}image/${s}`:T}const N=s=>s.quantity++,P=s=>s.quantity>1&&s.quantity--,w=(s,e)=>{const o=parseInt(e);o>=1&&(s.quantity=o)},_=l(()=>i.items.reduce((s,e)=>s+e.price*e.quantity,0)),g=l(()=>i.items.length>0?120:0);function x(s){const e={id:s.id,productTitle:s.productTitle,sellerName:s.sellerName,price:s.price,imageUrl:s.imageUrl,unit:s.unit,category:s.category,stock:s.stock};f.toggle(e)?p.success("已加入最愛"):p.info("已取消最愛"),s.favoriteAnimating=!0,setTimeout(()=>s.favoriteAnimating=!1,300)}function S(s){if(!confirm(`確定要刪除「${s.productTitle}」嗎？`))return;const e=document.getElementById("cart-"+s.id);j.to(e,{opacity:0,scale:.6,duration:.3,onComplete:()=>i.removeItem(s.id)})}function B(){v.push("/products")}const m=I(),b=l(()=>{if(i.items.length===0)return[];const s=l(()=>{const o={};return i.items.forEach(a=>{o[a.category]=(o[a.category]||0)+1}),Object.entries(o).sort((a,A)=>A[1]-a[1])[0][0]});let e=m.getProductsByCategory(s);return e.length===0&&(e=m.allProducts),e.filter(o=>!i.items.find(a=>a.id===o.id)).slice(0,6)});return(s,e)=>(n(),r(u,null,[t("div",Q,[t("div",R,[(n(!0),r(u,null,y(k(i).items,o=>(n(),r("div",{class:"buyProduct",key:o.id,id:"cart-"+o.id},[t("div",J,[t("div",K,[t("img",{src:$(o.imageUrl)},null,8,X)]),t("div",Y,[t("div",Z,[t("h6",{class:"title",onClick:a=>C(o)},c(o.productTitle),9,tt),t("p",st,c(o.sellerName),1),t("p",ot,c(o.unit),1)]),t("div",et,[t("i",{class:L([k(f).isFavorited(o.id)?"fa-solid fa-heart":"fa-regular fa-heart",{"favorite-animate":o.favoriteAnimating}]),onClick:a=>x(o)},null,10,at),t("i",{class:"fa-solid fa-xmark",onClick:a=>S(o)},null,8,ct)])])]),t("div",it,[t("div",nt,[e[0]||(e[0]=t("div",{class:"word"},"價格",-1)),t("div",rt,"NT$ "+c(o.price),1)]),t("div",dt,[t("button",{onClick:a=>P(o)},"-",8,lt),t("input",{type:"number",min:"1",value:o.quantity,onInput:a=>w(o,a.target.value)},null,40,ut),t("button",{onClick:a=>N(o)},"+",8,pt)]),t("div",vt,[e[1]||(e[1]=t("div",{class:"word"},"小計",-1)),t("div",ft,"NT$ "+c(o.price*o.quantity),1)])])],8,H))),128)),e[2]||(e[2]=t("div",{class:"listeningWord"},[t("h6",null,"請提前知悉"),t("p",null,"訂單一旦確認，將無法更改（顏色、尺寸、數量、付款方式 、點數、優惠券使用等）。"),t("p",null,"如果您購買預購商品或需要特別訂購的商品，配送時間可能會比平常慢。")],-1))]),t("div",_t,[t("div",gt,[t("div",mt,[e[3]||(e[3]=t("p",{class:"word"},"商品價格",-1)),t("p",bt,"NT$ "+c(_.value),1)]),e[5]||(e[5]=t("div",{class:"productPriceDiscount"},[t("p",{class:"word"},"商品折扣"),t("p",{class:"number"})],-1)),t("div",ht,[e[4]||(e[4]=t("p",{class:"word"},"運費",-1)),t("p",yt,"NT$ "+c(g.value),1)]),e[6]||(e[6]=t("div",{class:"freightDiscount"},[t("p",{class:"word"},"運費折扣"),t("p",{class:"number"})],-1))]),t("div",kt,[t("div",Ct,[e[7]||(e[7]=t("p",{class:"word"},"總付款金額",-1)),t("p",Tt,"NT$ "+c(_.value+g.value),1)])]),e[8]||(e[8]=F('<div class="box3" data-v-c76cbf88><div class="point" data-v-c76cbf88><p class="word" data-v-c76cbf88>可獲得點數</p><p class="number" data-v-c76cbf88></p></div></div><div class="box4" data-v-c76cbf88><div class="inputAccount" data-v-c76cbf88><label for="" data-v-c76cbf88>帳號</label><input type="text" placeholder="輸入帳號" data-v-c76cbf88></div><div class="imputPassword" data-v-c76cbf88><label for="" data-v-c76cbf88>密碼</label><input type="password" placeholder="輸入密碼" data-v-c76cbf88></div><div class="forget" data-v-c76cbf88><button type="button" class="forgot" data-v-c76cbf88>忘記帳號或密碼</button></div><div class="buttonBox" data-v-c76cbf88><button type="button" class="login" data-v-c76cbf88>登入繼續結帳</button><button type="button" class="register" data-v-c76cbf88>註冊會員繼續結帳</button></div></div>',2))])]),t("div",{class:"keep"},[t("button",{class:"keepShopping",onClick:B}," 繼續逛逛 ")]),h(M),b.value.length>0?(n(),r("div",$t,[e[9]||(e[9]=t("h3",{class:"recommendTitle"},"猜你喜歡",-1)),t("div",Nt,[(n(!0),r(u,null,y(b.value,o=>(n(),W(z,{key:o.id,id:o.id,productTitle:o.productTitle,sellerName:o.sellerName,price:o.price,unit:o.unit,imageUrl:o.imageUrl,category:o.category,stock:o.stock},null,8,["id","productTitle","sellerName","price","unit","imageUrl","category","stock"]))),128))])])):E("",!0),h(G)],64))}},Dt=q(Pt,[["__scopeId","data-v-c76cbf88"]]);export{Dt as default};
